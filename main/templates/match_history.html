{% extends "base.html" %}
{% load static %}
{% block content %}

<div class="max-w-5xl mx-auto px-4 py-10">
  <h1 class="text-2xl font-bold text-[#052962] mb-8">History Pertandingan</h1>

  {% regroup page_obj by date as date_groups %}
  {% for day in date_groups %}
    <div class="mb-10">
      <h2 class="text-xl font-semibold text-[#052962] mb-4">
        {{ day.grouper|date:"j F Y" }}
      </h2>

      {% regroup day.list by competition as league_groups %}
      {% for league in league_groups %}
        <div class="mb-3 border border-gray-200 rounded-lg overflow-hidden shadow-sm">
          <div class="bg-[#F6F6F6] px-4 py-2 text-[#052962] font-semibold text-sm">
            {{ league.grouper }}
          </div>

          {% for match in league.list %}
            <a href="{% url 'main:match_detail' match.id %}" 
               class="flex justify-between items-center px-4 py-3 bg-white border-t border-gray-100 hover:bg-gray-50 transition">

              <div class="flex items-center space-x-3 text-gray-800">
                <!-- HOME TEAM -->
                <div class="flex items-center space-x-2">
                  <img src="{% static 'images/logo/' %}{{ match.home_team|slugify }}.png"
                       alt="{{ match.home_team }} logo"
                       class="w-6 h-6 object-contain" />
                  <span class="font-medium text-sm md:text-base">{{ match.home_team }}</span>
                </div>

                <span class="font-semibold text-sm md:text-base">{{ match.home_score }}</span>
                <span class="text-gray-500">-</span>
                <span class="font-semibold text-sm md:text-base">{{ match.away_score }}</span>

                <!-- AWAY TEAM -->
                <div class="flex items-center space-x-2">
                  <img src="{% static 'images/logo/' %}{{ match.away_team|slugify }}.png"
                       alt="{{ match.away_team }} logo"
                       class="w-6 h-6 object-contain" />
                  <span class="font-medium text-sm md:text-base">{{ match.away_team }}</span>
                </div>
              </div>

              <div class="flex items-center space-x-4">
                <span class="text-gray-600 text-sm">{{ match.time|default:"-" }}</span>
                <span class="text-green-600 text-sm font-medium">Detail ›</span>
              </div>
            </a>
          {% endfor %}
        </div>
      {% endfor %}
    </div>
  {% endfor %}

  <!-- PAGINATION -->
  <div class="flex justify-center items-center space-x-2 mt-8">
    {% if page_obj.has_previous %}
      <a href="?page={{ page_obj.previous_page_number }}" 
         class="px-3 py-1 bg-[#052962] text-white rounded hover:bg-[#063b8b] transition">
         ‹ Prev
      </a>
    {% else %}
      <span class="px-3 py-1 bg-gray-200 text-gray-400 rounded cursor-not-allowed">‹ Prev</span>
    {% endif %}

    {% for num in page_obj.paginator.page_range %}
      {% if page_obj.number == num %}
        <span class="px-3 py-1 bg-[#dcd6cc] text-[#052962] font-semibold rounded">{{ num }}</span>
      {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
        <a href="?page={{ num }}" 
           class="px-3 py-1 bg-white text-[#052962] border border-gray-300 rounded hover:bg-[#f6f6f6] transition">
           {{ num }}
        </a>
      {% endif %}
    {% endfor %}

    {% if page_obj.has_next %}
      <a href="?page={{ page_obj.next_page_number }}" 
         class="px-3 py-1 bg-[#052962] text-white rounded hover:bg-[#063b8b] transition">
         Next ›
      </a>
    {% else %}
      <span class="px-3 py-1 bg-gray-200 text-gray-400 rounded cursor-not-allowed">Next ›</span>
    {% endif %}
  </div>
</div>

{% endblock %}
