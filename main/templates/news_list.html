{% extends "base.html" %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-10">
  <h1 class="text-3xl font-bold mb-8 text-gray-800">Berita Terbaru</h1>

  {% if user.is_authenticated and user.is_staff %}
  <div class="mb-6">
    <a href="{% url 'main:news_create' %}" class="bg-green-600 text-white px-4 py-2 rounded">+ Tambah Berita</a>
  </div>
  {% endif %}

  <div class="space-y-6">
    <form method="get" class="mb-4 flex gap-2">
        <input type="text" name="q" value="{{ q }}" placeholder="Cari berita..." class="border p-2 rounded flex-1" />
        <select name="category" class="border p-2 rounded">
            <option value="">Semua Kategori</option>
            {% for key, label in news_items.paginator.object_list.model.CATEGORY_CHOICES %}
            <option value="{{ key }}" {% if category == key %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>
        <button class="bg-blue-600 text-white px-3 py-2 rounded">Cari</button>
    </form>
    {% for item in news_items %}
    <a href="{% url 'main:news_detail' item.pk %}" class="block bg-white shadow rounded-lg p-5 hover:shadow-md transition">
      <div class="flex items-center space-x-4">
        <img src="{{ item.thumbnail }}" alt="Thumbnail" class="w-32 h-20 object-cover rounded">
        <div>
          <h2 class="text-xl font-semibold text-gray-800">{{ item.title }}</h2>
          <p class="text-gray-500 text-sm">{{ item.source }} â€” {{ item.publish_time|date:"j F Y" }}</p>
          <p class="text-gray-600 mt-1 line-clamp-2">{{ item.content|slice:":120" }}...</p>
        </div>
      </div>
    </a>
    {% empty %}
      <p class="text-gray-500">Belum ada berita.</p>
    {% endfor %}

    
    <div class="mt-6">
    <nav>
        {% if news_items.has_previous %}
        <a href="?page={{ news_items.previous_page_number }}&q={{ q }}&category={{ category }}" class="px-2">Prev</a>
        {% endif %}
        <span>Page {{ news_items.number }} of {{ news_items.paginator.num_pages }}</span>
        {% if news_items.has_next %}
        <a href="?page={{ news_items.next_page_number }}&q={{ q }}&category={{ category }}" class="px-2">Next</a>
        {% endif %}
    </nav>
    </div>
  </div>
</div>
{% endblock %}
